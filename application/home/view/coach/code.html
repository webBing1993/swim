{extend name="public/common"}

{block name="style"}
<title>教练频道</title>
<link rel="stylesheet" href="/home/css/coach/code.css">
{/block}

{block name="body"}


<div class="box">
	<div class="bg">
		<img src="/home/images/coach/code.png" alt="" class="code">
		<div id="qrcode">
			<img src="{$data.header}" alt="条形码" class="header">
		</div>
	</div>

</div>

{/block}

{block name="script"}
<script src="/static/code/qrcode.min.js"></script>
<script>
	$(function () {
		//退出
		isOut();
    })
$(function(){

	var ww = $('body').width();
	var qrcode = new QRCode($('#qrcode')[0], {
		text: '{$data.mobile}',
		width: ww*5/10,
		height: ww*5/10,
		correctLevel: QRCode.CorrectLevel.H
	});
})
    //退出清理tab缓存
    function isOut(){
        pushHistory();
        setTimeout(function(){
            window.addEventListener("popstate", function(e) {
                delCookie("type");
                window.location.href = "/home/coach/index.html";
            }, false);
        },200)
    }
    //防止恶意刷新
    function pushHistory(){
        var sta = {
            title: "title"
        };
        if( window.history.state === null )
        {
            window.history.pushState( sta, "title" );
        }
        window.addEventListener("popstate", function(e) {
            window.history.go(0);
        }, false);
    }
    function setCookie(name,value){
        var Days = 30;
        var exp = new Date();
        exp.setTime(exp.getTime() + Days*24*60*60*1000);
        document.cookie = name + "="+ value + ";expires=" + exp.toGMTString();
    }
    function getCookie(name){
        var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)");
        if(arr=document.cookie.match(reg))
            return arr[2];
        else
            return null;
    }
    function delCookie(name){
        var exp = new Date();
        exp.setTime(exp.getTime() - 1);
        var cval=getCookie(name);
        if(cval!=null)
            document.cookie= name + "="+cval+";expires="+exp.toGMTString();
    }


</script>
{/block}